<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>En-tête DSFR</title>

    <!-- Grist API -->
    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>

    <!-- DSFR CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.13.1/dist/dsfr/dsfr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.13.1/dist/dsfr/utility/utilities.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.13.1/dist/utility/icons/icons.min.css">

    <style>
        .fr-header,
        .fr-header__brand {
            filter: none !important;
            --hover: transparent;
            --active: transparent;
        }
    </style>
</head>

<body>
    <header role="banner" class="fr-header" id="header-2">
        <div class="fr-header__body">
            <div class="fr-container">
                <div class="fr-header__body-row">
                    <div class="fr-header__brand fr-enlarge-link">
                        <div class="fr-header__brand-top">
                            <div class="fr-header__logo">
                                <p class="fr-logo" id="intitule-officiel">Intitulé <br>officiel</p>
                            </div>
                        </div>
                        <div class="fr-header__service">
                            <p class="fr-header__service-title" id="nom-service">Nom du site / service</p>
                            <p class="fr-header__service-tagline" id="baseline">baseline - précisions sur l'organisation
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- DSFR JavaScript -->
    <script>
        // Configuration des colonnes
        grist.ready({
            columns: [
                { name: "intitule_officiel", title: "Intitulé officiel", type: "Text", optional: true },
                { name: "nom_service", title: "Titre", type: "Text", optional: true },
                { name: "baseline", title: "Sous-titre", type: "Text", optional: true }
            ],
            requiredAccess: 'read table'
        });

        // Mise à jour des données
        grist.onRecord(function (record, mappings) {
            const mapped = grist.mapColumnNames(record, mappings);

            if (mapped) {
                // Intitulé officiel - préserver les retours à la ligne existants ou valeur par défaut
                if (mapped.intitule_officiel) {
                    // Remplacer les retours à la ligne (\n) par des <br>
                    const intitule = mapped.intitule_officiel.replace(/\n/g, '<br>');
                    document.getElementById('intitule-officiel').innerHTML = intitule;
                } else {
                    document.getElementById('intitule-officiel').innerHTML = 'République<br>Française';
                }

                // Nom du service
                document.getElementById('nom-service').textContent = mapped.nom_service || '';

                // Baseline
                document.getElementById('baseline').textContent = mapped.baseline || '';
            }
        });

        grist.onRecords(function (records, mappings) {
            if (records && records.length > 0) {
                const mapped = grist.mapColumnNames(records[0], mappings);

                if (mapped) {
                    // Intitulé officiel - préserver les retours à la ligne existants ou valeur par défaut
                    if (mapped.intitule_officiel) {
                        // Remplacer les retours à la ligne (\n) par des <br>
                        const intitule = mapped.intitule_officiel.replace(/\n/g, '<br>');
                        document.getElementById('intitule-officiel').innerHTML = intitule;
                    } else {
                        document.getElementById('intitule-officiel').innerHTML = 'République<br>Française';
                    }

                    // Nom du service
                    document.getElementById('nom-service').textContent = mapped.nom_service || '';

                    // Baseline
                    document.getElementById('baseline').textContent = mapped.baseline || '';
                }
            }
        });
    </script>

</body>

</html>